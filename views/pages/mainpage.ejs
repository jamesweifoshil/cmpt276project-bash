<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <% include ../partials/header.ejs %>
    <% include ../partials/nav-out.ejs %>
    <!-- <link rel="stylesheet" href="/public/stylesheets/mainPage.css"> -->
    <style type="text/css" media="screen">
      #editor { 
          position: absolute;
          top: 2%;
          right: 2%;
          bottom: 2%;
          left: 2%;
          margin-top: 151px;
      }
    </style>
  </head>
  <body>
    <% if (user.role === 'admin') { %>
      <h1>You are in Administrator view</h1>
    <% }else { %>
      <h1>Hello user <%=user.username%> </h1>
    <% } %>
    <div id="editnav" class="container-fluid text-center">
      <div class="row">
        <a class="btn btn-sm btn-danger pull-left col-xs-2" href="/logout">Logout</a>
        <a class="btn btn-sm btn-success pull-left col-xs-2" href="./fileUpload">Upload an Avatar Image</a>
        <input class="btn btn-sm btn-warning pull-left col-xs-2" type="file" id="openbtn" onchange="openCode(this.files)" value="Open">
      </div>
      <!-- <input class="btn btn-sm btn-warning" type="button" id="downloadbtn" onclick="downloadHTML()" value="Download"> -->
    </div>

    <!-- Ace text-editor package: https://ace.c9.io/#nav=about -->
    <div id="editor" class="pull-left">function foo(items) {
        var x = "All this is syntax highlighted";
        return x;
    }</div>


    <!-- <form action="/saveEditorText" method="post">
      <div class="">
        <input id="saveEditorText" name="editorText" type="submit" value="">
      </div> -->

    </form>
      

    <!-- Theme CDNs for ACE text editor  -->
    <script src="http://ajaxorg.github.io/ace-builds/src/ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="http://ajaxorg.github.io/ace-builds/src/ext-modelist.js" type="text/javascript" charset="utf-8"></script>
  <script src="https://pagecdn.io/lib/ace/1.4.12/ace.min.js" crossorigin="anonymous" integrity="sha256-T5QdmsCQO5z8tBAXMrCZ4f3RX8wVdiA0Fu17FGnU1vU=" ></script>
  
  <script src="https://pagecdn.io/lib/ace/1.4.12/theme-monokai.min.js" crossorigin="anonymous"  ></script>
  
  <script src="https://pagecdn.io/lib/ace/1.4.12/snippets/c_cpp.min.js" crossorigin="anonymous"  ></script>
  <script src="https://pagecdn.io/lib/ace/1.4.12/mode-c_cpp.min.js" crossorigin="anonymous"  ></script>

  <script src="https://pagecdn.io/lib/ace/1.4.12/worker-javascript.min.js" crossorigin="anonymous"  ></script>
  <script src="https://pagecdn.io/lib/ace/1.4.12/snippets/javascript.min.js" crossorigin="anonymous"  ></script>
  <script src="https://pagecdn.io/lib/ace/1.4.12/mode-javascript.min.js" crossorigin="anonymous"  ></script>  
  
  <!-- <script src="/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script> -->
  <script>
      var editor = ace.edit("editor");
      editor.setTheme("ace/theme/monokai");
      editor.session.setMode("ace/mode/javascript");

      function openCode(files) {
          var file = files[0]
          if (!file) return;
          var modelist = ace.require("ace/ext/modelist")
          var modeName = modelist.getModeForPath(file.name).mode 
          editor.session.setMode(modeName)
          reader = new FileReader();
          reader.onload = function() {
              editor.session.setValue(reader.result)
          }  
          reader.readAsText(file) 
      }

      //Store all ines of text from ace text editor in an array
      var myArray = editor.session.getDocument().$lines;

      
      //write code array to file...
      //const fs = require('fs');

  </script>
  </body>
</html>